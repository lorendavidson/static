<!DOCTYPE html>
<html>
<head>
  <script>
    function fetchDetails(name) {
      const url = 'https://script.google.com/macros/s/AKfycbxAhV0TXik7FsftVLezoiZZLGgepIExS2IBEaA4itm48146_kXJfRdZWBroZZ_A7YqIaA/exec';
      fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: 'name=' + encodeURIComponent(name)
      })
      .then(res => res.json())
      .then(data => {
        if (data.name && data.email) {
          const parentDoc = window.parent.document;
          parentDoc.querySelector("input[name='wholesaleDistributorName']").value = data.name;
          parentDoc.querySelector("input[name='wholesaleDistributorEmail']").value = data.email;
        }
      });
    }

    function watchDropdown() {
      const parentDoc = window.parent.document;
      const dropdown = parentDoc.querySelector("select[name='wholesaleDistributors']");
      if (dropdown) {
        dropdown.addEventListener('change', () => {
          fetchDetails(dropdown.value);
        });
      }
    }

    window.onload = () => setTimeout(watchDropdown, 1000);
  </script>
</head>
<body>
  <p>Initializing distributor auto-fillâ€¦</p>
</body>
</html>